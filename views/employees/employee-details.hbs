<section class="mt-3 mb-3">
  <div class="title-container">
    <h2 class="text-center">Detalles del empleado</h2>
    <div class="title-line"></div>
  </div>
  <nav class="w-100">
    <div
      class="nav nav-tabs justify-content-center"
      id="nav-tab"
      role="tablist"
    >
      <button
        class="nav-link {{#unless vacationAdded}}active{{/unless}}"
        id="nav-info-tab"
        data-bs-toggle="tab"
        data-bs-target="#nav-info"
        type="button"
        role="tab"
        aria-controls="nav-info"
        aria-selected="{{#if vacationAdded}}false{{else}}true{{/if}}"
      >
        Información
      </button>
      <button
        class="nav-link"
        id="nav-payroll-tab"
        data-bs-toggle="tab"
        data-bs-target="#nav-payroll"
        type="button"
        role="tab"
        aria-controls="nav-payroll"
        aria-selected="false"
      >
        Nómina
      </button>
      <button
        class="nav-link {{#if vacationAdded}}active{{/if}}"
        id="nav-vacation-tab"
        data-bs-toggle="tab"
        data-bs-target="#nav-vacation"
        type="button"
        role="tab"
        aria-controls="nav-vacation"
        aria-selected="{{#if vacationAdded}}true{{else}}false{{/if}}"
      >
        Vacaciones
      </button>
    </div>
  </nav>
  <div class="tab-content" id="nav-tabContent">
    <div
      class="tab-pane fade {{#unless vacationAdded}}show active{{/unless}}"
      id="nav-info"
      role="tabpanel"
      aria-labelledby="nav-info-tab"
    >
      {{! Info }}
      <div class="employee-details">
        <img
          src="/assets/images/uploaded/{{employee.imgPath}}"
          alt="Imagen del empleado"
        />
        <div class="details-content">
          <strong>Nombre</strong>
          <p class="text-capitalize">{{employee.name}}</p>
          <strong>Apellido</strong>
          <p class="text-capitalize">{{employee.lastName}}</p>
          <strong>Fecha de nacimiento</strong>
          <p>{{employee.dateOfBirth}}</p>
          <strong>Género</strong>
          <p>{{employee.gender}}</p>
        </div>
        <div class="details-content">
          <strong>Teléfono</strong>
          <p>{{employee.phone}}</p>
          <strong>Correo electrónico</strong>
          <p>{{employee.email}}</p>
          <strong>Dirección</strong>
          <p>{{employee.address}}</p>
          <strong>Puesto</strong>
          <p>{{employee.jobPosition}}</p>
        </div>
      </div>
      {{! Info }}
    </div>
    <div
      class="tab-pane fade"
      id="nav-payroll"
      role="tabpanel"
      aria-labelledby="nav-payroll-tab"
    >
      {{! Payroll }}
      <div class="pay-detail mt-5 mb-1">
        <div class="text-center">
          <h3>Sueldo bruto</h3>
          <p>{{employee.payroll.grossPay}}RD$</p>
        </div>
        <div class="text-center">
          <h3>Sueldo neto</h3>
          <p>{{employee.payroll.netPay}}RD$</p>
        </div>
      </div>
      <div class="employee-details">
        <div class="details-content">
          <strong>Descuento del ISR (Impuesto Sobre la Renta)</strong>
          <p>{{employee.payroll.ISR}}RD$</p>
          <strong>Descuento del ARS (Seguro Social de Salud)</strong>
          <p>{{employee.payroll.ARS}}RD$</p>
          <strong>Descuento del AFP (Fondo de Pensiones)</strong>
          <p>{{employee.payroll.AFP}}RD$</p>
        </div>
      </div>
      {{! Payroll }}
    </div>
    <div
      class="tab-pane fade {{#if vacationAdded}}show active{{/if}}"
      id="nav-vacation"
      role="tabpanel"
      aria-labelledby="nav-vacation-tab"
    >
      {{! Vacations }}
      <div class="text-center mt-3 mb-3">
        <button class="circle-btn" id="btn-collapse">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
          >
            <path
              fill="currentColor"
              d="M11 19v-6H5v-2h6V5h2v6h6v2h-6v6h-2Z"
            ></path>
          </svg>
        </button>
      </div>
      <div id="collapse-form" style="display: none;">
        <div class="card form-card mx-auto mb-4" style="max-width: 500px;">
          <div class="card-header">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
            ><path
                fill="currentColor"
                d="M17 6h-2V3c0-.55-.45-1-1-1h-4c-.55 0-1 .45-1 1v3H7c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2c0 .55.45 1 1 1s1-.45 1-1h6c0 .55.45 1 1 1s1-.45 1-1c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zM8.75 18c-.41 0-.75-.34-.75-.75v-7.5c0-.41.34-.75.75-.75s.75.34.75.75v7.5c0 .41-.34.75-.75.75zM12 18c-.41 0-.75-.34-.75-.75v-7.5c0-.41.34-.75.75-.75s.75.34.75.75v7.5c0 .41-.34.75-.75.75zm1.5-12h-3V3.5h3V6zm1.75 12c-.41 0-.75-.34-.75-.75v-7.5c0-.41.34-.75.75-.75s.75.34.75.75v7.5c0 .41-.34.75-.75.75z"
              ></path></svg>
            <h4 class="mb-0">Agregar vacaciones</h4>
          </div>
          <div class="card-body">
            <div class="alert-container">
              {{#if formMsg}}
                <div class="alert alert-warning form-alert">
                  <div>
                    <i class="bi bi-exclamation-triangle-fill"></i>
                    <label>{{formMsg}}</label>
                  </div>
                  <button
                    type="button"
                    class="btn-close"
                    id="form-alert-btn"
                  ></button>
                </div>
              {{/if}}
            </div>
            <form
              method="POST"
              action="/employees/employee-details/{{employee.id}}"
              id="form-vacation"
            >
              <input type="hidden" name="id" value="{{employee.id}}" />
              <div class="row">
                <div class="col-12">
                  <div class="form-group mb-2">
                    <label class="form-label" for="start">Fecha de inicio:</label>
                    <input
                      class="form-control form-control-sm required"
                      type="date"
                      id="start"
                      name="startDate"
                    />
                  </div>
                  <div class="form-group mb-2">
                    <label class="form-label" for="end">Fecha de finalización:</label>
                    <input
                      class="form-control form-control-sm required"
                      type="date"
                      id="end"
                      name="endDate"
                    />
                  </div>
                  <div class="buttons-container">
                    <button
                      type="button"
                      class="btn btn-warning form-btn form-btn-primary ms-1"
                      id="btn-addVacation"
                    >
                      Agregar
                    </button>
                  </div>
                </div>
              </div>
            </form>
          </div>
        </div>
      </div>
      {{#each employee.vacations}}
        <div class="card vacation-card mt-2 mb-3">
          <div class="card-header">
            <h5 class="card-title mb-0">
              Estado de las vacaciones:
              <span class="badge">
                {{#if (isVacationOver this.endDate)}}
                  Finalizada
                {{else}}
                  Activa
                {{/if}}
              </span>
            </h5>
          </div>
          <div class="card-body">
            <ul class="list-unstyled">
              <li>
                <strong>Fecha de inicio:</strong>
                <label>{{this.startDate}}</label>
              </li>
              <li>
                <strong>Fecha de finalización:</strong>
                <label>{{this.endDate}}</label>
              </li>
              <li>
                <strong>Cantidad de días:</strong>
                <label>{{this.days}}</label>
              </li>
              <li>
                <strong>Monto pagado:</strong>
                <label>{{this.pay}}RD$</label>
              </li>
            </ul>
          </div>
        </div>
      {{else}}
        <div class="no-vacations mt-5">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
          ><path
              fill="currentColor"
              d="m19.775 22.6l-7.025-7.025v-2.85l6.25 6.25V19q0 .825-.588 1.413T17 21q0 .425-.288.713T16 22q-.425 0-.713-.288T15 21H9q0 .425-.288.713T8 22q-.425 0-.713-.288T7 21q-.825 0-1.413-.588T5 19V8q0-.825.463-1.413T6.025 6l.9.9v2.85L1.375 4.2q-.3-.3-.288-.713t.313-.712q.3-.3.713-.3t.712.3l18.375 18.4q.3.3.288.713t-.313.712q-.3.3-.7.3t-.7-.3Zm-7.025-7.025l-1.5-1.5v3.175q0 .325.213.537T12 18q.325 0 .537-.213t.213-.537v-1.675Zm-3.25-3.25l-1.5-1.5v6.425q0 .325.213.537T8.75 18q.325 0 .537-.213t.213-.537v-4.925ZM10.5 6h3V3.5h-3V6ZM19 16.125l-3-3V9.75q0-.325-.213-.537T15.25 9q-.325 0-.537.213t-.213.537v1.875L8.875 6H9V3q0-.425.288-.713T10 2h4q.425 0 .713.288T15 3v3h2q.825 0 1.413.588T19 8v8.125Zm-4.5-.15v1.275q0 .325.213.537t.537.213q.325 0 .537-.213T16 17.25v-1.275h-1.5Z"
            ></path></svg>
          <h5>Este empleado no tiene vacaciones registradas</h5>
        </div>
      {{/each}}
      {{! Vacations }}
    </div>
  </div>
</section>